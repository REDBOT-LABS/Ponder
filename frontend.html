<!DOCTYPE html>
<html>

<head>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
    <link href="./main.css" rel="stylesheet">
    <script>
        var ip = 'http://127.0.0.1:7486'
        const http = new XMLHttpRequest();
        var pgp = false;

        function togglePGP() {//enables and disables visibility of the 
            if (document.getElementById('pgp').checked) {
                document.getElementById('public-key').style.display = 'inline';
            }
            else {
                document.getElementById('public-key').style.display = 'none';
            }
        }

        var darkmode = true;

        function toggleDark() {
            if (darkmode) {
                document.getElementById('body').classList.remove('darkmode');
            }
            else {
                document.getElementById('body').classList.add('darkmode')
            }
            darkmode = !darkmode;
        }

        function sendpost() {
            http.open("POST", `${ip}/post?${btoa(document.getElementById('post').value)}`);
            http.send();
        }

        function getpost() {
            let post = "";
            http.open("POST", `${ip}/get?${btoa(post)}`);
            http.send();
        }

        function getrandompost() {
            let post = "";
            http.open("POST", `${ip}/get?${btoa(random)}`);
            http.send();
        }

        http.onreadystatechange = (e) => {
            document.getElementById('response').value = http.responseText;
        }

    </script>
</head>

<body id='body' class="darkmode">
    <center>
        <h3>v1.4</h3>
        <div id="options" class="banner">
            <label>
                <input type="checkbox" id="darkmode" onchange="toggleDark()" checked>
                Dark mode
            </label>
        </div>
        <textarea id='post' type="text" style="height: 10vh; width: 50vw; text-align: left; resize: none;"
            placeholder=" Type a post here..."></textarea>
        <div id="buttons">
            <button onclick="sendpost()">Post As</button>
            <input type="text" id="username" style="width: auto; font-family: monospace;" placeholder="Username">
            <button onclick="getpost()">debug: Get Post</button>
            <label>
                Verify
                <input type="checkbox" id="pgp" onchange="togglePGP()">
                <input type="text" id="public-key" placeholder="PGP signature..." style="
                    font-family: monospace; 
                    display: none;">
            </label>

        </div>
        <input disabled id='response' type="text" style="height: 25vh; width: 50vw;" onload="getrandompost()">
    </center>
</body>

</html>